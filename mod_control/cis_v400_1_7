{
  "index": "8b23967c-2337-436f-b78d-f19d765167ff",
  "description": "Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests users make to Google cloud services accessible to that particular service account. It is recommended that all Service Account keys are regularly rotated.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_1_7",
  "severity": "medium",
  "sql": "select\n  'https://iam.googleapis.com/v1/projects/' || project || '/serviceAccounts/' || service_account_name || '/keys/' || name as resource,\n  case\n    when valid_after_time <= (current_date - interval '90' day) then 'alarm'\n    else 'ok'\n  end as status,\n  service_account_name || ' ' || name || ' created ' || to_char(valid_after_time , 'DD-Mon-YYYY') ||\n    ' (' || extract(day from current_timestamp - valid_after_time) || ' days).'\n  as reason\n  , location as location, project as project\nfrom\ngcp.gcp_service_account_key\nwhere\n  key_type = 'USER_MANAGED'\nand project_id=projectId\nand cd_snapshot_version=snapshotVersion;",
  "title": "1.7 Ensure User-Managed/External Keys for Service Accounts Are Rotated Every 90 Days or Fewer",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.iam_service_account_key_age_90",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    23,
    23,
    55,
    51,
    699625000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project",
  "isMaster": true,
  "__path": "/home/piyushnijhawan/Desktop/steampipe-mod-gcp-compliance/cis_v400/mod_control/cis_v400_1_7"
}