{
  "index": "160a30da-f2ea-4e97-b974-6430825f340b",
  "description": "It is recommended to create a sink that will export copies of all the log entries. This can help aggregate logs from multiple projects and export them to a Security Information and Event Management (SIEM).",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_2_2",
  "severity": "high",
  "sql": "with project_sink_count as (   select     project,     count(*) no_of_sink   from     gcp_logging_sink   where     filter = ''     and destination != ''   group by     project ) select   'https://www.googleapis.com/logging/v2/projects/' || s.project resource,   case     when s.no_of_sink > 0 then 'ok'     else 'alarm'   end as status,   case     when s.no_of_sink > 0       then 'Sinks configured for all log entries.'     else 'Sinks not configured for all log entries.'   end as reason      , p.project_id as project from   gcp_project p   left join project_sink_count s on s.project = p.project_id;",
  "title": "2.2 Ensure That Sinks Are Configured for All Log Entries",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.manual_control",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    14,
    3,
    5,
    43,
    305904000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project",
  "isMaster": true
}