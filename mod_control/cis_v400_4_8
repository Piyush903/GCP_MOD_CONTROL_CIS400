{
  "index": "b01bdbc1-196f-475d-a7b9-05aebbd46f08",
  "description": "To defend against advanced threats and ensure that the boot loader and firmware on your VMs are signed and untampered, it is recommended that Compute instances are launched with Shielded VM enabled.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_4_8",
  "severity": "medium",
  "sql": "select\n  self_link resource,\n  case\n    when shielded_instance_config @> '{\"enableVtpm\": true, \"enableIntegrityMonitoring\": true}' then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when shielded_instance_config @> '{\"enableVtpm\": true, \"enableIntegrityMonitoring\": true}'\n      then title || ' shielded VM enabled.'\n    else title || ' shielded VM not enabled.'\n  end as reason\n  \n  , location as location, project as project\nfrom\n  gcp.gcp_compute_instance\nwhere project_id=projectId\nand cd_snapshot_version=snapshotVersion;",
  "title": "4.8 Ensure Compute Instances Are Launched With Shielded VM Enabled",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.compute_instance_shielded_vm_enabled",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    23,
    23,
    55,
    51,
    708338000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project"
}