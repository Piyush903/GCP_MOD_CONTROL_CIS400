{
  "index": "84dba0cf-3bf6-4018-9154-6409a8542547",
  "description": "Enabling retention policies on log buckets will protect logs stored in cloud storage buckets from being overwritten or accidentally deleted. It is recommended to set up retention policies and configure Bucket Lock on all storage buckets that are used as log sinks.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_2_3",
  "severity": "high",
  "sql": "with logging_sinks as (   select     self_link,     title,     _ctx,     project,     destination   from     gcp_logging_sink ) select   s.self_link resource,   case     when b.retention_policy is not null and b.retention_policy ->> 'isLocked' = 'true' then 'ok'     else 'alarm'   end as status,   case     when b.retention_policy is not null and b.retention_policy ->> 'isLocked' = 'true'       then s.title || '''s logging bucket ' || b.name || ' has retention policies configured.'     else s.title || '''s logging bucket ' || b.name || ' has retention policies not configured.'   end as reason   , s.project as project from   gcp_storage_bucket b   join logging_sinks s on (   split_part(s.destination, '/', 1) = 'storage.googleapis.com'   and split_part(s.destination, '/', 2) = b.name );",
  "title": "2.3 Ensure That Retention Policies on Cloud Storage Buckets Used for Exporting Logs Are Configured Using Bucket Lock",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.manual_control",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    14,
    3,
    5,
    43,
    305930000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project",
  "isMaster": true
}