{
  "index": "03dc021b-c3fa-441b-9646-c75613ff3096",
  "description": "The `log_min_messages` flag defines the minimum message severity level that is considered as an error statement. Messages for error statements are logged with the SQL statement. Valid values include DEBUG5, DEBUG4, DEBUG3, DEBUG2, DEBUG1, INFO, NOTICE, WARNING, ERROR, LOG, FATAL, and PANIC. Each severity level includes the subsequent levels mentioned above. ERROR is considered the best practice setting. Changes should only be made in accordance with the organization's logging policy.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_6_2_5",
  "severity": "low",
  "sql": "select\n  self_link as resource,\n  case\n    when database_version not like 'POSTGRES%' then 'skip'\n    when database_flags is null or not (database_flags @> '[{\"name\":\"log_min_messages\"}]') then 'alarm'\n    when database_flags @> '[{\"name\":\"log_min_messages\",\"value\":\"error\"}]' or database_flags @> '[{\"name\":\"log_min_messages\",\"value\":\"warning\"}]' then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when database_version not like 'POSTGRES%' then title || ' not a PostgreSQL database.'\n    when database_flags is null or not (database_flags @> '[{\"name\":\"log_min_messages\"}]') then title || ' log_min_messages database flag not set.'\n    when database_flags @> '[{\"name\":\"log_min_messages\",\"value\":\"error\"}]' then title || ' log_min_messages database flag set to ERROR.'\n    when database_flags @> '[{\"name\":\"log_min_messages\",\"value\":\"warning\"}]' then title || ' log_min_messages database flag set to WARNING.'\n    else title || ' log_min_messages database flag not set at minimum to WARNING.'\n  end as reason\n  \n  , location as location, project as project\nfrom\n gcp.gcp_sql_database_instance where project_id = projectId   and cd_snapshot_version = snapshotVersion;",
  "title": "6.2.5 Ensure that the 'Log_min_messages' Flag for a Cloud SQL PostgreSQL Instance is set at minimum to 'Warning'",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.sql_instance_postgresql_log_min_messages_database_flag_error",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    23,
    23,
    55,
    51,
    702457000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project"
}