{
  "index": "4fd115f0-1bd7-45e7-b739-eea8718fa5f4",
  "description": "DNSSEC algorithm numbers in this registry may be used in CERT RRs. Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. The algorithm used for key signing should be a recommended one and it should be strong.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_3_4",
  "severity": "medium",
  "sql": "select\n  self_link resource,\n  case\n    when visibility = 'private' then 'skip'\n    when dnssec_config_state is null then 'alarm'\n    when dnssec_config_default_key_specs @> '[{\"keyType\": \"keySigning\", \"algorithm\": \"rsasha1\"}]' then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when visibility = 'private'\n      then title || ' is private.'\n    when dnssec_config_state is null\n      then title || ' DNSSEC not enabled.'\n    when dnssec_config_default_key_specs @> '[{\"keyType\": \"keySigning\", \"algorithm\": \"rsasha1\"}]'\n      then title || ' using RSASHA1 algorithm for key-signing.'\n    else title || ' not using RSASHA1 algorithm for key-signing.'\n  end as reason\n  \n  , location as location, project as project\nfrom\n  gcp.gcp_dns_managed_zone\nwhere project_id=projectId\nand cd_snapshot_version=snapshotVersion;",
  "title": "3.4 Ensure That RSASHA1 Is Not Used for the Key-Signing Key in Cloud DNS DNSSEC",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.dns_managed_zone_key_signing_not_using_rsasha1",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    23,
    23,
    55,
    51,
    709445000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project"
}