{
  "index": "07715740-0250-46c1-a4b6-ce60ad36ec03",
  "description": "Use corporate login credentials instead of consumer accounts, such as Gmail accounts.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_1_1",
  "severity": "medium",
  "sql": "with user_with_access as (   select     distinct split_part(m, ':', 2) as member,     project,     _ctx,     location   from     gcp.gcp_iam_policy,     jsonb_array_elements(bindings) as b,    jsonb_array_elements_text(b -> 'members') as m   where project_id=projectId and cd_snapshot_version=snapshotVersion and m like 'user:%' ) select   case when (select count(*) from gcp.gcp_organization where project_id=projectId and cd_snapshot_version=snapshotVersion) = 0 then a.project else a.member end as resource,   case     when (select count(*) from gcp.gcp_organization where project_id=projectId and cd_snapshot_version=snapshotVersion) = 0 then 'info'     when org.display_name is null then 'alarm'     else 'ok'   end as status,   case     when (select count(*) from gcp.gcp_organization where project_id=projectId and cd_snapshot_version=snapshotVersion) = 0 then 'Plugin authentication mechanism does not have organization viewer permission.'     when org.display_name is null then a.member || ' uses non-corporate login credentials.'     else a.member || ' uses corporate login credentials.'   end as reason   , a.project as project from   user_with_access as a   left join gcp.gcp_organization as org on split_part(a.member, '@', 2) = org.display_name where org.project_id=projectId and org.cd_snapshot_version=snapshotVersion  limit case when (select count(*) from gcp.gcp_organization where project_id=projectId and cd_snapshot_version=snapshotVersion) = 0 then 1 end;",
  "title": "1.1 Ensure that Corporate Login Credentials are Used",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.iam_user_uses_corporate_login_credentials",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    23,
    23,
    55,
    51,
    699485000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project"
}