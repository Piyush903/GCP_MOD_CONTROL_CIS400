{
  "index": "bfca4f74-4c66-41da-9ed8-872d9eab0f10",
  "description": "API Keys should only be used for services in cases where other authentication methods are unavailable. API keys are always at risk because they can be viewed publicly, such as from within a browser, or they can be accessed on a device where the key resides. It is recommended to restrict API keys to use (call) only APIs required by an application.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_1_14",
  "severity": "medium",
  "sql": "select    'https://iam.googleapis.com/v1/projects/' || project || '/apikeys/' || name as resource,   case     when restrictions -> 'apiTargets' is null then 'alarm'     else 'ok'   end as status,   case     when restrictions -> 'apiTargets' is null then title || ' API key is not restricted to required APIs.'     else title || ' API key is restricted to only required APIs.'   end as reason   , location as location, project as project from   gcp.gcp_apikeys_key where project_id=projectId\nand cd_snapshot_version=snapshotVersion;",
  "title": "1.14 Ensure API Keys Are Restricted to Only APIs That Application Needs Access",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.iam_api_key_restricts_apis",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    23,
    23,
    55,
    51,
    699998000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project"
}
