{
  "index": "2a20d9c1-1669-4dc7-8cb3-d3f3e5542c2a",
  "description": "It is recommended that Cloud Audit Logging is configured to track all admin activities and read, write access to user data.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_2_1",
  "severity": "high",
  "sql": "with default_audit_configs as (   select     *   from     (       select         service,         string_agg(log ->> 'logType', ', ') log_types,         string_agg(log ->> 'exemptedMembers', ', ') exempted_user,         _ctx,         project       from         gcp_audit_policy,         jsonb_array_elements(audit_log_configs) as log       group by         service, project, _ctx     ) logs   where     log_types like '%DATA_WRITE%'     and log_types like '%DATA_READ%'     and log_types like '%ADMIN_READ%'     and service = 'allServices' ) select   default_audit_configs.service resource,   case     when default_audit_configs.exempted_user is null then 'ok'     else 'alarm'   end as status,   case     when default_audit_configs.exempted_user is null       then 'Audit logging properly configured across all services and no exempted users associated.'     else 'Audit logging not configured as per CIS requirement or default audit setting having exempted user.'   end as reason   , default_audit_configs.project as project from   default_audit_configs;",
  "title": "2.1 Ensure That Cloud Audit Logging Is Configured Properly",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.manual_control",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    14,
    3,
    5,
    43,
    305877000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project",
  "isMaster": true
}