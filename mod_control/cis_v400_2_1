{
  "index": "ef2b747c-f051-4453-b01e-4597177e8d2d",
  "description": "It is recommended that Cloud Audit Logging is configured to track all admin activities and read, write access to user data.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_2_1",
  "severity": "low",
  "sql": "with default_audit_configs as (\n  select\n    *\n  from\n    (\n      select\n        service,\n        string_agg(log ->> 'logType', ', ') as log_types,\n        string_agg(log ->> 'exemptedMembers', ', ') as exempted_user,\n        location,\n        project\n      from\n        gcp.gcp_audit_policy,\n        jsonb_array_elements(audit_log_configs) as log\n      where\n        project_id=projectId and cd_snapshot_version=snapshotVersion\n      group by\n        service, project, location\n    ) logs\n  where\n    log_types like '%DATA_WRITE%'\n    and log_types like '%DATA_READ%'\n    and log_types like '%ADMIN_READ%'\n    and service = 'allServices'\n)\nselect\n  default_audit_configs.service as resource,\n  case\n    when default_audit_configs.exempted_user is null then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when default_audit_configs.exempted_user is null\n      then 'Audit logging properly configured across all services and no exempted users associated.'\n    else 'Audit logging not configured as per CIS requirement or default audit setting having exempted user.'\n  end as reason,\n  default_audit_configs.location as location,\n  default_audit_configs.project as project\nfrom\n  default_audit_configs;",
  "title": "2.1 Ensure That Cloud Audit Logging Is Configured Properly",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.audit_logging_configured_for_all_service",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    23,
    23,
    55,
    51,
    711387000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project"
}