{
  "index": "5b1a701f-14ad-4da7-9020-05a88ec1ed41",
  "description": "Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine. If you supply your own encryption keys, Google uses your key to protect the Google-generated keys used to encrypt and decrypt your data. By default, Google Compute Engine encrypts all data at rest. Compute Engine handles and manages this encryption for you without any additional actions on your part. However, if you wanted to control and manage this encryption yourself, you can provide your own encryption keys.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_4_7",
  "severity": "medium",
  "sql": "select\n  self_link resource,\n  case\n    when disk_encryption_key_type = 'Customer supplied' then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when disk_encryption_key_type = 'Customer supplied'\n      then title || ' encrypted with customer-supplied encryption keys (CSEK).'\n    when disk_encryption_key_type = 'Customer managed'\n      then title || ' encrypted with customer-managed encryption keys.'\n    else title || ' encrypted with default Google-managed keys.'\n  end as reason\n  \n  , location as location, project as project\nfrom\n  gcp.gcp_compute_disk\nwhere project_id=projectId\nand cd_snapshot_version=snapshotVersion;",
  "title": "4.7 Ensure VM Disks for Critical VMs Are Encrypted With Customer-Supplied Encryption Keys (CSEK)",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.compute_disk_encrypted_with_csk",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    23,
    23,
    55,
    51,
    708325000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project"
}