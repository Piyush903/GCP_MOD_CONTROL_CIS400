{
  "index": "0eba2f5e-371b-443b-aeaa-39953037e387",
  "description": "It is recommended that the principle of 'Separation of Duties' is enforced while assigning service-account related roles to users.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_1_8",
  "severity": "high",
  "sql": "with users_with_roles as (   select     distinct split_part(member_entity, ':', 2) as user_name,     project,     _ctx,     p ->> 'role' as assigned_role   from     gcp_iam_policy,     jsonb_array_elements(bindings) as p,     jsonb_array_elements_text(p -> 'members') as member_entity   where     split_part(member_entity, ':', 1) = 'user' ), account_admin_users as(   select     user_name,     project   from     users_with_roles   where assigned_role = 'roles/iam.serviceAccountAdmin' ), account_users as(   select     user_name,     project   from     users_with_roles   where assigned_role = 'roles/iam.serviceAccountUser' ) select   distinct user_name as resource,   case     when user_name in (select user_name from account_users) and user_name in (select user_name from account_admin_users) then 'alarm'     else 'ok'   end as status,   case     when user_name in (select user_name from account_users) and user_name in (select user_name from account_admin_users)       then  user_name || ' assigned with both Service Account Admin and Service Account User roles.'     else user_name || ' not assigned with both Service Account Admin and Service Account User roles.'   end as reason   , project as project from   users_with_roles;",
  "title": "1.8 Ensure That Separation of Duties Is Enforced While Assigning Service Account Related Roles to Users",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.manual_control",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    14,
    3,
    5,
    43,
    295780000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project",
  "isMaster": true
}