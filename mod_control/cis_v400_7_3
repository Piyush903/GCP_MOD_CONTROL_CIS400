{
  "index": "24fcc247-9919-4f47-8d2f-375f5ed966fd",
  "description": "BigQuery by default encrypts the data as rest by employing `Envelope Encryption` using Google managed cryptographic keys. The data is encrypted using the data encryption keys and data encryption keys themselves are further encrypted using key encryption keys. This is seamless and do not require any additional input from the user. However, if you want to have greater control, Customer-managed encryption keys (CMEK) can be used as encryption key management solution for BigQuery Data Sets.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_7_3",
  "severity": "medium",
  "sql": "SELECT\n  self_link AS resource,\n  CASE\n    WHEN kms_key_name IS NULL THEN 'alarm'\n    ELSE 'ok'\n  END AS status,\n  CASE\n    WHEN kms_key_name IS NULL\n      THEN title || ' encrypted with Google-managed cryptographic keys.'\n    ELSE title || ' encrypted with customer-managed encryption keys.'\n  END AS reason,\n  location AS location,\n  project AS project\nFROM\n  gcp.gcp_bigquery_dataset\nWHERE\n  project_id = projectId\n  AND cd_snapshot_version = snapshotVersion;",
  "title": "7.3 Ensure That a Default Customer-Managed Encryption Key (CMEK) Is Specified for All BigQuery Data Sets",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.manual_control",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    23,
    10,
    15,
    29,
    724977000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project",
  "isMaster": true,
  "__path": "/home/piyushnijhawan/Desktop/steampipe-mod-gcp-compliance/cis_v400/mod_control/cis_v400_7_3"
}