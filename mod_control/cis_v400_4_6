{
  "index": "7b548342-fd1c-42bb-81bc-b79fe2b0d1e0",
  "description": "Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. However, both capabilities are required if you want to use instances to help route packets.",
  "modName": "gcp_compliance",
  "resourceName": "cis_v400_4_6",
  "severity": "medium",
  "sql": "select\n  self_link resource,\n  case\n    when name like 'gke-%' and labels ? 'goog-gke-node' then 'skip'\n    when can_ip_forward then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when name like 'gke-%' and labels ? 'goog-gke-node'\n      then title || ' created by GKE.'\n    when can_ip_forward\n      then title || ' IP forwarding enabled.'\n    else title || ' IP forwarding not enabled.'\n  end as reason\n  \n  , location as location, project as project\nfrom\n  gcp.gcp_compute_instance\nwhere project_id=projectId\nand cd_snapshot_version=snapshotVersion;",
  "title": "4.6 Ensure That IP Forwarding Is Not Enabled on Instances",
  "path": null,
  "qualifiedName": null,
  "query": "gcp_compliance.query.compute_instance_ip_forwarding_disabled",
  "controlLevel": "master",
  "createdAt": [
    2025,
    11,
    23,
    23,
    55,
    51,
    708298000
  ],
  "remediationAvailable": false,
  "anonymous": false,
  "type": "Project"
}